name: Default Credentials Detection
version: 1.0.0
type: evaluation
author: pentora-core

metadata:
  severity: critical
  tags: [authentication, default-credentials, misconfiguration]
  references:
    - https://cwe.mitre.org/data/definitions/798.html

# Trigger when service is detected
triggers:
  - data_key: service.name
    condition: in
    value: [ssh, telnet, ftp, mysql, postgresql, redis]

# Match known default usernames
match:
  logic: OR
  rules:
    # Admin/admin
    - field: auth.username
      operator: in
      value: [admin, root, administrator]

    # Default MySQL/PostgreSQL users
    - field: auth.username
      operator: in
      value: [mysql, postgres, sa]

    # Redis no auth
    - field: redis.auth_required
      operator: equals
      value: false

output:
  vulnerability: true
  severity: critical
  message: "Service may be using default or weak credentials"
  remediation: "Change default credentials immediately and enforce strong password policies"
  reference: "https://cwe.mitre.org/data/definitions/798.html"
  metadata:
    cwe: "CWE-798"
    owasp: "A07:2021-Identification and Authentication Failures"
