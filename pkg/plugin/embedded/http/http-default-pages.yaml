name: HTTP Default Installation Pages
version: 1.0.0
type: evaluation
author: pentora-security

metadata:
  severity: low
  tags: [http, configuration, default-content, information-disclosure]
  references:
    - https://owasp.org/www-community/vulnerabilities/Default_Pages
    - https://cwe.mitre.org/data/definitions/548.html

# Trigger when HTTP response body is detected
triggers:
  - data_key: http.body
    condition: exists
    value: true

# Detect default installation pages
match:
  logic: OR
  rules:
    - field: http.body
      operator: contains
      value: "Apache2 Ubuntu Default Page"
    - field: http.body
      operator: contains
      value: "Welcome to nginx!"
    - field: http.body
      operator: contains
      value: "Test Page for the Apache HTTP Server"
    - field: http.body
      operator: contains
      value: "IIS Windows Server"
    - field: http.body
      operator: contains
      value: "Welcome to CentOS"
    - field: http.body
      operator: contains
      value: "It works!"
    - field: http.title
      operator: contains
      value: "Apache2 Debian Default Page"
    - field: http.title
      operator: contains
      value: "Welcome to nginx"

output:
  vulnerability: true
  severity: low
  message: "HTTP server is displaying default installation page"
  remediation: "Remove default pages and configure proper web content. This indicates incomplete server configuration"
  reference: "https://owasp.org/www-community/vulnerabilities/Default_Pages"
