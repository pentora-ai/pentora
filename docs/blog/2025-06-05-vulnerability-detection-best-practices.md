---
slug: vulnerability-detection-best-practices
title: "Best Practices for Vulnerability Detection and Management"
authors: [security_research]
tags: [vulnerability-assessment, security, best-practices]
---

Effective vulnerability management goes beyond running scans. Learn industry best practices for detection, prioritization, and remediation.

<!-- truncate -->

## The Vulnerability Management Challenge

Security teams face overwhelming volume:

- **40+ new CVEs published daily** (14,600+ per year)
- **Average organization has 1,000+ vulnerabilities** in their environment
- **Limited remediation capacity**: Most teams can patch 50-100 vulns/month
- **Alert fatigue**: Too many low-priority findings

The key is **prioritization** and **systematic approach**.

## Detection Best Practices

### 1. Comprehensive Asset Discovery

You can't protect what you don't know about:

```bash
# Quarterly full network discovery
pentora scan 0.0.0.0/0 \
  --only-discover \
  --exclude-private=false \
  --output asset-inventory-Q2-2025.json

# Daily change detection
pentora scan 192.168.0.0/16 \
  --only-discover \
  --compare-with asset-inventory-baseline.json \
  --alert-on-changes
```

**Recommendation:**
- Full discovery: Monthly
- Change detection: Daily
- Critical assets: Continuous monitoring

### 2. Accurate Service Fingerprinting

Vulnerability matching requires precise version information:

```bash
# Use aggressive fingerprinting for critical assets
pentora scan critical-servers.txt \
  --fingerprint-mode aggressive \
  --all-probes \
  --timeout 10s
```

**Common pitfall**: Using default timeout too short for accurate fingerprinting.

✅ **Good:** 5-10s timeout with layered probes
❌ **Bad:** 1s timeout with single probe

### 3. Multi-Source Vulnerability Data

Don't rely on a single CVE database:

```yaml
# pentora-vuln-config.yaml
vulnerability_sources:
  - nist_nvd:
      api_key: ${NVD_API_KEY}
      priority: 1

  - github_security_advisories:
      enabled: true
      priority: 2

  - vendor_advisories:
      enabled: true
      vendors:
        - ubuntu
        - debian
        - redhat
        - microsoft
      priority: 3

  - exploit_db:
      enabled: true
      priority: 4
```

Pentora correlates data from multiple sources for comprehensive coverage.

### 4. Authenticated vs. Unauthenticated Scanning

**Unauthenticated scanning** (external attacker perspective):

```bash
pentora scan external-assets.txt \
  --vuln \
  --perspective external
```

Finds:
- Exposed services
- Version disclosure vulnerabilities
- Default credentials
- Public-facing misconfigurations

**Authenticated scanning** (internal perspective):

```bash
pentora scan internal-servers.txt \
  --vuln \
  --credentials creds.yaml \
  --perspective internal
```

Finds:
- Missing patches
- Local privilege escalation
- Configuration issues
- Installed vulnerable libraries

**Best Practice:** Run both monthly.

## Prioritization Framework

### CVSS Alone Is Not Enough

Don't just sort by CVSS score. Consider:

1. **Exploitability**: Is exploit code public?
2. **Asset Criticality**: Production vs. dev environment?
3. **Exposure**: Internet-facing vs. internal-only?
4. **Business Impact**: Revenue-generating vs. non-critical?

### Pentora's Risk Scoring

Pentora calculates composite risk score:

```
Risk Score = (CVSS × 0.3) + (Exploitability × 0.3) + (Exposure × 0.2) + (Asset Criticality × 0.2)

Where:
- CVSS: 0-10 (normalized)
- Exploitability: 0-10 (0=no exploit, 10=exploit in the wild)
- Exposure: 0-10 (0=isolated, 10=internet-facing)
- Asset Criticality: 0-10 (user-defined)
```

Example:

```json
{
  "cve": "CVE-2021-44228",
  "cvss_score": 10.0,
  "exploitability": 10.0,
  "exposure": 10.0,
  "asset_criticality": 9.0,
  "risk_score": 9.7,
  "priority": "CRITICAL"
}
```

vs.

```json
{
  "cve": "CVE-2023-XXXX",
  "cvss_score": 9.8,
  "exploitability": 2.0,
  "exposure": 2.0,
  "asset_criticality": 3.0,
  "risk_score": 4.3,
  "priority": "MEDIUM"
}
```

### Define Asset Criticality

```yaml
# asset-criticality.yaml
asset_groups:
  - name: "Production Web Servers"
    pattern: "prod-web-*"
    criticality: 10

  - name: "Production Databases"
    pattern: "prod-db-*"
    criticality: 10

  - name: "Payment Processing"
    pattern: "*payment*"
    criticality: 10

  - name: "Staging Environment"
    pattern: "staging-*"
    criticality: 5

  - name: "Dev Environment"
    pattern: "dev-*"
    criticality: 3
```

Scan with criticality:

```bash
pentora scan 192.168.1.0/24 \
  --vuln \
  --asset-criticality ./asset-criticality.yaml \
  --sort-by risk_score
```

## Remediation Workflow

### 1. Triage

Categorize findings:

```bash
pentora workspace show scan-2025-06-05 \
  --vuln-only \
  --group-by priority

# Output
CRITICAL (Patch immediately): 12 vulnerabilities
  - CVE-2021-44228 (Log4Shell) - 5 assets
  - CVE-2022-22965 (Spring4Shell) - 3 assets
  - CVE-2023-XXXX - 4 assets

HIGH (Patch within 7 days): 45 vulnerabilities
MEDIUM (Patch within 30 days): 123 vulnerabilities
LOW (Patch within 90 days): 234 vulnerabilities
```

### 2. Create Remediation Plan

```bash
# Export actionable list
pentora workspace show scan-2025-06-05 \
  --vuln-only \
  --priority critical,high \
  --format csv \
  -o remediation-plan.csv
```

CSV includes:
- Asset (IP/hostname)
- Vulnerability (CVE)
- Severity
- CVSS score
- Risk score
- Affected service/port
- Recommended fix
- Reference URLs

### 3. Track Progress

Create tickets automatically:

```bash
pentora scan 192.168.1.0/24 \
  --vuln \
  --priority critical,high \
  --create-jira-tickets \
  --jira-project VULN \
  --jira-assignee security-team
```

Or integrate with ServiceNow:

```bash
pentora scan 192.168.1.0/24 \
  --vuln \
  --priority critical,high \
  --create-servicenow-incidents \
  --servicenow-assignment-group "Security Operations"
```

### 4. Verify Remediation

After patching:

```bash
# Rescan specific hosts
pentora scan patched-servers.txt \
  --vuln \
  --compare-with scan-2025-06-05 \
  --show-only-resolved

# Output
=== Resolved Vulnerabilities ===

Host: 192.168.1.50
  ✅ CVE-2021-44228 (Log4Shell) - RESOLVED
     Before: log4j 2.14.0
     After: log4j 2.17.1

Host: 192.168.1.51
  ✅ CVE-2022-22965 (Spring4Shell) - RESOLVED
     Before: Spring Framework 5.3.15
     After: Spring Framework 5.3.18
```

## Continuous Monitoring

### Scheduled Scans

```bash
# crontab -e

# Daily quick scan (top ports + known vulns)
0 2 * * * pentora scan 192.168.0.0/16 \
  --vuln \
  --ports common \
  --fast \
  --alert-on-critical

# Weekly comprehensive scan
0 3 * * 0 pentora scan 192.168.0.0/16 \
  --vuln \
  --ports all \
  --credentials /etc/pentora/creds.yaml \
  --format pdf \
  -o /var/reports/weekly-vuln-$(date +\%Y\%m\%d).pdf

# Monthly full discovery + vuln assessment
0 4 1 * * pentora scan 192.168.0.0/16 \
  --vuln \
  --ports all \
  --comprehensive \
  --include-compliance pci-dss,cis
```

### Real-Time Alerting

Slack integration:

```yaml
# pentora-alerts.yaml
alerts:
  - name: "Critical Vulnerabilities"
    condition: priority == "critical"
    destinations:
      - slack:
          webhook: ${SLACK_WEBHOOK}
          channel: "#security-critical"
          mention: "@security-team"

  - name: "Public Exploits"
    condition: exploitability >= 8
    destinations:
      - slack:
          webhook: ${SLACK_WEBHOOK}
          channel: "#security-alerts"
      - email:
          to: security-team@example.com
          subject: "Public Exploit Detected"

  - name: "Internet-Facing Vulns"
    condition: exposure >= 8 AND cvss >= 7
    destinations:
      - pagerduty:
          integration_key: ${PD_KEY}
          severity: high
```

### Trend Analysis

Track vulnerability posture over time:

```bash
pentora workspace trend \
  --metric vulnerabilities \
  --timeframe 6m \
  --group-by priority
```

Output:

```
Vulnerability Trend (6 months)

Critical:  ████░░░░░░░░  12 → 3  (-75%) ✓
High:      ██████░░░░░░  85 → 34 (-60%) ✓
Medium:    ████████░░░░  210 → 156 (-26%) ✓
Low:       ██████████░░  340 → 287 (-16%) ✓

MTTR (Mean Time to Remediate):
- Critical: 2.3 days (target: 1 day)
- High: 8.5 days (target: 7 days)
- Medium: 25 days (target: 30 days)
```

## Common Pitfalls

### ❌ Pitfall 1: Scanning Too Infrequently

**Problem:** Quarterly scans miss new vulnerabilities.

**Solution:**
- Critical assets: Weekly
- Production: Weekly
- Staging/Dev: Monthly

### ❌ Pitfall 2: Ignoring Context

**Problem:** Treating all CVSS 9.8 vulnerabilities equally.

**Solution:** Use composite risk score considering exploitability and exposure.

### ❌ Pitfall 3: No Verification

**Problem:** Assuming patches worked without verification.

**Solution:** Always rescan after remediation.

### ❌ Pitfall 4: Alert Fatigue

**Problem:** Too many low-priority alerts ignored.

**Solution:**
- Alert only on critical/high
- Batch medium/low for weekly review
- Auto-create tickets instead of real-time alerts

### ❌ Pitfall 5: Lack of Ownership

**Problem:** No one responsible for remediation.

**Solution:**
- Assign vulnerabilities to teams automatically
- Track SLAs per severity
- Executive dashboards showing responsibility

## Integration with SIEM

Forward vulnerability data to SIEM for correlation:

```bash
# Send to Splunk
pentora scan 192.168.0.0/16 \
  --vuln \
  --forward-to splunk \
  --splunk-hec https://splunk.example.com:8088 \
  --splunk-token ${HEC_TOKEN}

# Send to QRadar
pentora scan 192.168.0.0/16 \
  --vuln \
  --forward-to qradar \
  --qradar-host qradar.example.com \
  --qradar-token ${QRADAR_TOKEN}

# Send to Microsoft Sentinel
pentora scan 192.168.0.0/16 \
  --vuln \
  --forward-to sentinel \
  --sentinel-workspace ${WORKSPACE_ID} \
  --sentinel-key ${SHARED_KEY}
```

SIEM can correlate:
- Vulnerability scan results
- IDS/IPS alerts
- Login attempts
- Network traffic anomalies

Example correlation:

```
[Splunk Query]
index=vulnerabilities CVE="CVE-2021-44228"
| join host [search index=firewall action=allow dst_port=443]
| where exploitability > 8
| table host, vuln_severity, last_seen_firewall, risk_score
```

## Reporting for Stakeholders

### Executive Dashboard

```bash
pentora workspace report \
  --type executive \
  --timeframe 1m \
  --format pdf \
  -o executive-report-$(date +\%Y-%m).pdf
```

Includes:
- High-level metrics (total vulns, trend)
- Risk score distribution
- Top 10 critical vulnerabilities
- MTTR by severity
- Compliance status

### Technical Report

```bash
pentora workspace report \
  --type technical \
  --include-remediation-steps \
  --format pdf \
  -o technical-vuln-report.pdf
```

Includes:
- Detailed vulnerability list
- Affected assets
- Proof of concept (where available)
- Remediation steps
- References (CVE, vendor advisories)

## Conclusion

Effective vulnerability management requires:

1. ✅ Comprehensive and accurate detection
2. ✅ Context-aware prioritization
3. ✅ Systematic remediation workflow
4. ✅ Continuous monitoring
5. ✅ Stakeholder communication

Pentora provides the tools—your process makes them effective.

**Start improving your vulnerability management today:**

```bash
pentora scan <your-network> --vuln --prioritize
```

---

**Resources:**
- [Vulnerability Assessment Guide](/docs/guides/vulnerability-assessment)
- [Risk Scoring Documentation](/docs/concepts/risk-scoring)
- [Integration Examples](/docs/integrations/siem)
